{% extends "base_dark.html" %}

{% block title %}Donate Blood - Blood Network{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-lg-8">
        <div class="card">
            <div class="card-header">
                <h3><i class="bi bi-heart-pulse"></i> Blood Donation Appointment</h3>
                <p class="mb-0 text-muted">Fill out the form below to schedule your donation</p>
            </div>
            <div class="card-body">
                <form method="POST" class="needs-validation" novalidate>
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="name" class="form-label">Full Name *</label>
                            <input type="text" class="form-control" id="name" name="name" required>
                            <div class="invalid-feedback">Please provide your full name.</div>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="age" class="form-label">Age *</label>
                            <input type="number" class="form-control" id="age" name="age" min="18" max="65" required>
                            <div class="invalid-feedback">Age must be between 18 and 65 years.</div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="gender" class="form-label">Gender *</label>
                            <select class="form-select" id="gender" name="gender" required>
                                <option value="">Select Gender</option>
                                <option value="Male">Male</option>
                                <option value="Female">Female</option>
                                <option value="Other">Other</option>
                            </select>
                            <div class="invalid-feedback">Please select your gender.</div>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="blood_group" class="form-label">Blood Group *</label>
                            <select class="form-select" id="blood_group" name="blood_group" required>
                                <option value="">Select Blood Group</option>
                                <option value="A+">A+</option>
                                <option value="A-">A-</option>
                                <option value="B+">B+</option>
                                <option value="B-">B-</option>
                                <option value="AB+">AB+</option>
                                <option value="AB-">AB-</option>
                                <option value="O+">O+</option>
                                <option value="O-">O-</option>
                            </select>
                            <div class="invalid-feedback">Please select your blood group.</div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="phone" class="form-label">Phone Number *</label>
                            <input type="tel" class="form-control" id="phone" name="phone" pattern="[0-9]{10}" required>
                            <div class="invalid-feedback">Please provide a valid 10-digit phone number.</div>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="city" class="form-label">City *</label>
                            <select class="form-select" id="city" name="city" required>
                                <option value="">Select City</option>
                                {% for city in cities %}
                                    <option value="{{ city.city }}">{{ city.city }}</option>
                                {% endfor %}
                            </select>
                            <div class="invalid-feedback">Please select your city.</div>
                        </div>
                    </div>
                    
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="hospital_id" class="form-label">Preferred Hospital *</label>
                            <select class="form-select" id="hospital_id" name="hospital_id" disabled required>
                                <option value="">Select City First</option>
                            </select>
                            <div class="invalid-feedback">Please select a hospital.</div>
                        </div>
                        
                        <div class="col-md-6 mb-3">
                            <label for="preferred_time" class="form-label">Preferred Date & Time *</label>
                            <input type="datetime-local" class="form-control" id="preferred_time" name="preferred_time" required>
                            <div class="invalid-feedback">Please select your preferred appointment time.</div>
                        </div>
                    </div>
                    
                    <!-- Eligibility Checklist -->
                    <div class="card bg-dark-card border-accent mb-4">
                        <div class="card-body">
                            <h5 class="text-accent mb-3">
                                <i class="bi bi-clipboard-check"></i> Eligibility Confirmation
                            </h5>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="weight_check" required>
                                <label class="form-check-label" for="weight_check">
                                    I weigh more than 50 kg (110 lbs)
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="health_check" required>
                                <label class="form-check-label" for="health_check">
                                    I am in good general health
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="donation_check" required>
                                <label class="form-check-label" for="donation_check">
                                    It has been at least 90 days since my last blood donation
                                </label>
                            </div>
                            <div class="form-check mb-2">
                                <input class="form-check-input" type="checkbox" id="medication_check" required>
                                <label class="form-check-label" for="medication_check">
                                    I am not currently taking antibiotics or other disqualifying medications
                                </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="consent_check" required>
                                <label class="form-check-label" for="consent_check">
                                    I consent to the blood donation process and health screening
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center">
                        <button type="submit" class="btn btn-primary btn-lg">
                            <i class="bi bi-calendar-plus"></i> Book Appointment
                        </button>
                        <a href="{{ url_for('index') }}" class="btn btn-outline-light btn-lg ms-3">
                            <i class="bi bi-arrow-left"></i> Back to Home
                        </a>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<!-- Information Cards -->
<div class="row mt-4">
    <div class="col-md-4">
        <div class="card">
            <div class="card-body text-center">
                <i class="bi bi-clock text-accent" style="font-size: 3rem;"></i>
                <h5 class="mt-3">Quick Process</h5>
                <p class="text-muted">Donation takes only 10-15 minutes</p>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card">
            <div class="card-body text-center">
                <i class="bi bi-shield-check text-accent" style="font-size: 3rem;"></i>
                <h5 class="mt-3">Safe & Sterile</h5>
                <p class="text-muted">All equipment is sterile and single-use</p>
            </div>
        </div>
    </div>
    
    <div class="col-md-4">
        <div class="card">
            <div class="card-body text-center">
                <i class="bi bi-heart text-accent" style="font-size: 3rem;"></i>
                <h5 class="mt-3">Save Lives</h5>
                <p class="text-muted">One donation can save up to 3 lives</p>
            </div>
        </div>
    </div>
</div>

<script>
// Set minimum datetime to current time
document.addEventListener('DOMContentLoaded', function() {
    const now = new Date();
    now.setMinutes(now.getMinutes() - now.getTimezoneOffset());
    document.getElementById('preferred_time').min = now.toISOString().slice(0, 16);
});
</script>
{% endblock %}